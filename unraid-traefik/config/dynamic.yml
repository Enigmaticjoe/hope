# Traefik Dynamic Configuration with nip.io
# Access via: https://[service].192.168.1.222.nip.io

http:
  routers:
    # jAI Homepage
    jai:
      rule: "Host(`jai.192.168.1.222.nip.io`) || Host(`192.168.1.222.nip.io`)"
      service: jai
      entryPoints:
        - websecure
      tls: {}

    # Open WebUI
    openwebui:
      rule: "Host(`chat.192.168.1.222.nip.io`)"
      service: openwebui
      entryPoints:
        - websecure
      tls: {}

    # vLLM API
    vllm:
      rule: "Host(`vllm.192.168.1.222.nip.io`)"
      service: vllm
      entryPoints:
        - websecure
      tls: {}

    # Ollama
    ollama:
      rule: "Host(`ollama.192.168.1.222.nip.io`)"
      service: ollama
      entryPoints:
        - websecure
      tls: {}

    # SearXNG
    searxng:
      rule: "Host(`search.192.168.1.222.nip.io`)"
      service: searxng
      entryPoints:
        - websecure
      tls: {}

    # AnythingLLM
    anythingllm:
      rule: "Host(`rag.192.168.1.222.nip.io`)"
      service: anythingllm
      entryPoints:
        - websecure
      tls: {}

    # Portainer on Unraid
    portainer:
      rule: "Host(`portainer.192.168.1.222.nip.io`)"
      service: portainer
      entryPoints:
        - websecure
      tls: {}

  services:
    jai:
      loadBalancer:
        servers:
          - url: "http://jai-web:80"

    openwebui:
      loadBalancer:
        servers:
          - url: "http://192.168.1.9:3000"

    vllm:
      loadBalancer:
        servers:
          - url: "http://192.168.1.9:8000"

    ollama:
      loadBalancer:
        servers:
          - url: "http://192.168.1.9:11434"

    searxng:
      loadBalancer:
        servers:
          - url: "http://192.168.1.9:8888"

    anythingllm:
      loadBalancer:
        servers:
          - url: "http://192.168.1.9:3001"

    portainer:
      loadBalancer:
        servers:
          - url: "https://192.168.1.222:9443"
        serversTransport: insecure

  serversTransports:
    insecure:
      insecureSkipVerify: true

# Self-signed certificate for nip.io domains
tls:
  certificates:
    - certFile: /etc/traefik/certs/nip.crt
      keyFile: /etc/traefik/certs/nip.key
